<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andy Grogan-Kaylor">
<meta name="dcterms.date" content="2024-11-12">

<title>Bayesian and Frequentist Multilevel Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="Bayesian-and-frequentist-MLM_files/libs/clipboard/clipboard.min.js"></script>
<script src="Bayesian-and-frequentist-MLM_files/libs/quarto-html/quarto.js"></script>
<script src="Bayesian-and-frequentist-MLM_files/libs/quarto-html/popper.min.js"></script>
<script src="Bayesian-and-frequentist-MLM_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Bayesian-and-frequentist-MLM_files/libs/quarto-html/anchor.min.js"></script>
<link href="Bayesian-and-frequentist-MLM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Bayesian-and-frequentist-MLM_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="Bayesian-and-frequentist-MLM_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="Bayesian-and-frequentist-MLM_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Bayesian-and-frequentist-MLM_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Bayesian-and-frequentist-MLM_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="Bayesian-and-frequentist-MLM_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="Bayesian-and-frequentist-MLM_files/libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="Bayesian-and-frequentist-MLM_files/libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="Bayesian-and-frequentist-MLM_files/libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#conceptual-appropriateness" id="toc-conceptual-appropriateness" class="nav-link" data-scroll-target="#conceptual-appropriateness"><span class="header-section-number">2</span> Conceptual Appropriateness</a></li>
  <li><a href="#accepting-the-null-hypothesis-h_0" id="toc-accepting-the-null-hypothesis-h_0" class="nav-link" data-scroll-target="#accepting-the-null-hypothesis-h_0"><span class="header-section-number">3</span> Accepting the Null Hypothesis (<span class="math inline">\(H_0\)</span>)</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison"><span class="header-section-number">4</span> Model Comparison</a></li>
  <li><a href="#prior-information" id="toc-prior-information" class="nav-link" data-scroll-target="#prior-information"><span class="header-section-number">5</span> Prior Information</a></li>
  <li><a href="#multiple-comparisons" id="toc-multiple-comparisons" class="nav-link" data-scroll-target="#multiple-comparisons"><span class="header-section-number">6</span> Multiple Comparisons</a></li>
  <li><a href="#smaller-samples" id="toc-smaller-samples" class="nav-link" data-scroll-target="#smaller-samples"><span class="header-section-number">7</span> Smaller Samples</a></li>
  <li><a href="#full-distribution-of-parameters" id="toc-full-distribution-of-parameters" class="nav-link" data-scroll-target="#full-distribution-of-parameters"><span class="header-section-number">8</span> Full Distribution of Parameters</a></li>
  <li><a href="#distributional-models" id="toc-distributional-models" class="nav-link" data-scroll-target="#distributional-models"><span class="header-section-number">9</span> Distributional Models</a></li>
  <li><a href="#non-linear-terms" id="toc-non-linear-terms" class="nav-link" data-scroll-target="#non-linear-terms"><span class="header-section-number">10</span> Non-Linear Terms</a></li>
  <li><a href="#maximal-models" id="toc-maximal-models" class="nav-link" data-scroll-target="#maximal-models"><span class="header-section-number">11</span> Maximal Models</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">12</span> References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Bayesian-and-frequentist-MLM.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bayesian and Frequentist Multilevel Modeling</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andy Grogan-Kaylor </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 12, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Bayesian-and-frequentist-MLM_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Simulated Multilevel Model"><img src="Bayesian-and-frequentist-MLM_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672" alt="Simulated Multilevel Model"></a></p>
<figcaption>Simulated Multilevel Model</figcaption>
</figure>
</div>
</div>
</div>
<p><span class="math display">\[y_{ij} = \beta_0 + \beta_1 x_{1i} + u_{0j} + u_{1j} x + e_{ij}\]</span></p>
<p>All multilevel models account for group structure, in estimating the association of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, by including a random intercept (<span class="math inline">\(u_0\)</span>), and possibly one or more random slope terms (<span class="math inline">\(u_1, u_2, etc....\)</span>).</p>
<p>Bayesian models may offer some advantages over frequentist models, but may be <em>substantially</em> slower to converge.</p>
</section>
<section id="conceptual-appropriateness" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Conceptual Appropriateness</h1>
<p>Following Kruschke <span class="citation" data-cites="Kruschke2014">(<a href="#ref-Kruschke2014" role="doc-biblioref">2014</a>)</span> all Bayesian models have a <em>conceptual appropriateness</em>.</p>
<p>In frequentist reasoning we are estimating the probability of observing data at least as extreme as our data, while assuming a null hypothesis (<span class="math inline">\(H_0\)</span>). As has been noted, <span class="math inline">\(H_0\)</span>, <em>e.g.</em> <span class="math inline">\(\beta = 0\)</span>, or <span class="math inline">\(\bar{x}_A - \bar{x}_B = 0\)</span>, is very often not a substantively interesting or substantively meaningful hypothesis.</p>
<p>In Bayesian analysis, we are not rejecting a null hypothesis. Instead, we are <em>directly estimating the value of a parameter</em> such as <span class="math inline">\(\beta\)</span> and are indeed estimating a <em>full probability distribution</em> for this parameter.</p>
</section>
<section id="accepting-the-null-hypothesis-h_0" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Accepting the Null Hypothesis (<span class="math inline">\(H_0\)</span>)</h1>
<p>The Bayesian approach means that we have the ability to accept the null hypothesis <span class="math inline">\(H_0\)</span> <span class="citation" data-cites="Kruschke2018">(<a href="#ref-Kruschke2018" role="doc-biblioref">Kruschke &amp; Liddell, 2018</a>)</span>. This ability to accept <span class="math inline">\(H_0\)</span> might possibly lead to theory simplification <span class="citation" data-cites="Gallistel2009 Morey2018">(<a href="#ref-Gallistel2009" role="doc-biblioref">Gallistel, 2009</a>; <a href="#ref-Morey2018" role="doc-biblioref">Morey et al., 2018</a>)</span>, as well as to a lower likelihood of the publication bias that results from frequentist methods predicated upon the rejection of <span class="math inline">\(H_0\)</span> <span class="citation" data-cites="Kruschke2018">(<a href="#ref-Kruschke2018" role="doc-biblioref">Kruschke &amp; Liddell, 2018</a>)</span>.</p>
</section>
<section id="model-comparison" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Model Comparison</h1>
<p>Relatedly, Bayesian approaches allow one to compare an alternative model <span class="math inline">\(H_A\)</span> with a null model <span class="math inline">\(H_0\)</span>, or to simply compare two alternative statistical models (<span class="math inline">\(H_1\)</span> vs.&nbsp;<span class="math inline">\(H_2\)</span>). Bayesian models may have a better perspective on these kinds of statistical comparisons than do frequentist approaches. As Jarosz et al. <span class="citation" data-cites="Jarosz2014">(<a href="#ref-Jarosz2014" role="doc-biblioref">2014</a>)</span> note:</p>
<blockquote class="blockquote">
<p>“All Bayesian approaches are comparisons of models. This means that a Bayes factor considers the likelihood of both the null and the alternative hypothesis. From the researcher’s standpoint, this is likely closer to their overall goal than simply rejecting the null hypothesis.”</p>
</blockquote>
</section>
<section id="prior-information" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Prior Information</h1>
<p>Bayesian models allow one to incorporate prior information about a parameter of interest.</p>
<p>Prior information may come from the prior research literature, e.g.&nbsp;from systematic reviews or meta-analyses, or expert opinion or clinical wisdom.</p>
<p>Kruschke <span class="citation" data-cites="Kruschke2014">(<a href="#ref-Kruschke2014" role="doc-biblioref">2014</a>)</span> points out that “No analysis is immune to false alarms, because randomly sampled data will occasionally contain accidental coincidences of outlying values.” However, according to Kruschke <span class="citation" data-cites="Kruschke2014">(<a href="#ref-Kruschke2014" role="doc-biblioref">2014</a>)</span> careful use of priors may reduce the probability of false alarms.</p>
</section>
<section id="multiple-comparisons" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Multiple Comparisons</h1>
<p>As Kruschke <span class="citation" data-cites="Kruschke2014">(<a href="#ref-Kruschke2014" role="doc-biblioref">2014</a>)</span> observes, multiple comparisons (especially when they are <em>post hoc</em>) are less of a concern for Bayesian analysis than they are for a frequentist analysis:</p>
<blockquote class="blockquote">
<p>“In a Bayesian analysis, however, there is just one posterior distribution over the parameters that describe the conditions. That posterior distribution is unaffected by the intentions of the experimenter, and the posterior distribution can be examined from multiple perspectives however is suggested by insight and curiosity.”</p>
</blockquote>
</section>
<section id="smaller-samples" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Smaller Samples</h1>
<p>Bayesian multilevel models may be better with small samples <span class="citation" data-cites="VandeSchoot2015 Rognli2022">(<a href="#ref-Rognli2022" role="doc-biblioref">Rognli et al., 2022</a>; <a href="#ref-VandeSchoot2015" role="doc-biblioref">van de Schoot et al., 2015</a>)</span>, especially samples with small numbers of Level 2 units <span class="citation" data-cites="Hox2012">(<a href="#ref-Hox2012" role="doc-biblioref">Hox et al., 2012</a>)</span>. Some of this advantage may occur when parameters are not normally distributed <span class="citation" data-cites="Muthen2012">(<a href="#ref-Muthen2012" role="doc-biblioref">Muthen &amp; Asparouhov, 2012</a>)</span>. It appears that much of this improvement in performance is dependent upon the use of informative priors <span class="citation" data-cites="Smid2020">(<a href="#ref-Smid2020" role="doc-biblioref">Smid et al., 2020</a>)</span>, and that Bayesian models with small samples may provide worse estimates than maximum likelihood estimates when less informative, or inaccurate, priors are used <span class="citation" data-cites="McNeish2016">(<a href="#ref-McNeish2016" role="doc-biblioref">McNeish, 2016</a>)</span>.</p>
</section>
<section id="full-distribution-of-parameters" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Full Distribution of Parameters</h1>
<p>Bayesian models of all kinds provide full distributions of the parameters (e.g.&nbsp;<span class="math inline">\(\beta\)</span>’s and random effects (<span class="math inline">\(u\)</span>’s))–both singly and jointly–rather than only point estimates.</p>
<p>Information about the full distribution of a parameter, such as the estimate of the probability distribution of values of a risk factor, a protective factor, or the effect of an intervention, may be substantively meaningful <span class="citation" data-cites="Rindskopf2020">(<a href="#ref-Rindskopf2020" role="doc-biblioref">Rindskopf, 2020</a>)</span>. Such information may be especially important when the distribution of a regression parameter is non-normal <span class="citation" data-cites="VandeSchoot2014 Finch2017">(<a href="#ref-Finch2017" role="doc-biblioref">Finch &amp; Bolin, 2017</a>; <a href="#ref-VandeSchoot2014" role="doc-biblioref">van de Schoot et al., 2014</a>)</span> e.g.&nbsp;in smaller samples.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Bayesian-and-frequentist-MLM_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Distribution of a Single Parameter"><img src="Bayesian-and-frequentist-MLM_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672" alt="Distribution of a Single Parameter"></a></p>
<figcaption>Distribution of a Single Parameter</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Bayesian-and-frequentist-MLM_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Joint Distribution of Parameters"><img src="Bayesian-and-frequentist-MLM_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672" alt="Joint Distribution of Parameters"></a></p>
<figcaption>Joint Distribution of Parameters</figcaption>
</figure>
</div>
</div>
</div>
<p>As Stata Corporation notes, “In a Bayesian multilevel model, <em>random effects</em> are model parameters just like regression coefficients and variance components” <span class="citation" data-cites="StataCorp2020">(<a href="#ref-StataCorp2020" role="doc-biblioref">StataCorp, 2020</a>)</span>. This ability to estimate the <em>distributions</em> of these random effects means that the <em>distribution</em> of the random effect for one group can be compared to another. For example, the <em>distribution</em> of a parameter in one country could be directly compared to the <em>distribution</em> of that same parameter in another country. One could even estimate the probability that a particular <span class="math inline">\(\beta\)</span> had a higher value in one group (e.g.&nbsp;country), than in another. As Balov <span class="citation" data-cites="Balov2016">(<a href="#ref-Balov2016" role="doc-biblioref">2016</a>)</span> suggests, this Bayesian approach allows us to “quantify the credibility” of these comparisons, which would not be possible with a frequentist approach. Rognli et al. <span class="citation" data-cites="Rognli2022">(<a href="#ref-Rognli2022" role="doc-biblioref">2022</a>)</span> make a similar point about estimating the probability of a practically or substantively meaningful effect size.</p>
<p>As an example, Stunnenberg et al. <span class="citation" data-cites="Stunnenberg2018">(<a href="#ref-Stunnenberg2018" role="doc-biblioref">2018</a>)</span> conducted a Bayesian analysis where the results of the multilevel analysis were used to inform treatment decisions. Here the data were repeated measures on patients, and thus the patients were the groups: “On completion of each treatment set, a Bayesian analysis was conducted to calculate the posterior probability of mexiletine [treatment] producing a clinically meaningful difference in the individual patient.”</p>
</section>
<section id="distributional-models" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Distributional Models</h1>
<p>Bayesian estimators allow one to directly model <span class="math inline">\(\sigma_{u_0}\)</span>, the variance of the Level 2 units, as a function of covariates <span class="citation" data-cites="Burkner2018">(<a href="#ref-Burkner2018" role="doc-biblioref">Burkner, 2018</a>)</span>. This <em>potentially</em> allows for the opportunity for this variation to become an outcome parameter of substantive interest.</p>
</section>
<section id="non-linear-terms" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Non-Linear Terms</h1>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Bayesian-and-frequentist-MLM_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Non-Linear Terms"><img src="Bayesian-and-frequentist-MLM_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672" alt="Non-Linear Terms"></a></p>
<figcaption>Non-Linear Terms</figcaption>
</figure>
</div>
</div>
</div>
<p>Bayesian estimators allow for the incorporation of non-linear terms <span class="citation" data-cites="Burkner2018">(<a href="#ref-Burkner2018" role="doc-biblioref">Burkner, 2018</a>)</span>. Such non-linear terms offer ways of non-parametrically fitting curvature. An open question is whether such methods represent a kind of over-fitting. A related question is the degree to which non-linear terms provide substantively interpretable results.</p>
</section>
<section id="maximal-models" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Maximal Models</h1>
<p>Hypothetically, one might imagine that there could be group level unobserved factors which affect regression slopes–i.e.&nbsp;the relationship between a predictor <em>x</em> and outcome variable <em>y</em>. Arguably, were one to ignore these unobserved factors in statistical estimation, they would show up either in an error term (<span class="math inline">\(e_i\)</span> or <span class="math inline">\(u_0\)</span>), or in the regression coefficients (<span class="math inline">\(\beta\)</span>). Were they to show up in the regression coefficients this would represent statistical bias and a substantive mis-estimation of important effects. thus, there is a conceptual argument for including as many random effects—i.e.&nbsp;random slopes—in a statistical model as possible.</p>
<p>Bayesian estimators more readily allow for the estimation of so called <em>maximal models</em> <span class="citation" data-cites="Barr2013 Frank2018">(<a href="#ref-Barr2013" role="doc-biblioref">Barr et al., 2013</a>; <a href="#ref-Frank2018" role="doc-biblioref">Frank, 2018</a>)</span>, which allow for the inclusion of a large number of random slopes, e.g.&nbsp;<span class="math inline">\(u_1, u_2, u_3, ..., etc.\)</span> even when some of those estimated slopes are close to 0.</p>
<p>It should be noted that Matuschek et al. <span class="citation" data-cites="Matuschek2017">(<a href="#ref-Matuschek2017" role="doc-biblioref">2017</a>)</span> argue that such a <em>maximal</em> approach may lead to a loss of statistical power and further argue that one should adhere to “a random effect structure that is supported by the data.”</p>
<p>In contrast, Nalborczyk et al. <span class="citation" data-cites="nalborczyk_batailler_loevenbruck_vilain_burkner_2019">(<a href="#ref-nalborczyk_batailler_loevenbruck_vilain_burkner_2019" role="doc-biblioref">2019</a>)</span> argue that maximal models are supported under the Bayesian approach. Oberauer <span class="citation" data-cites="Oberauer2022">(<a href="#ref-Oberauer2022" role="doc-biblioref">2022</a>)</span> also argues for including multiple random slopes. Schielzeth and Forstmeier <span class="citation" data-cites="Schielzeth2009">(<a href="#ref-Schielzeth2009" role="doc-biblioref">2009</a>)</span> make a similar argument from a frequentist perspective.</p>
</section>
<section id="references" class="level1 unnumbered" data-number="12">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">12 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Balov2016" class="csl-entry" role="listitem">
Balov, N. (2016). Bayesian hierarchical models in stata. <em>2016 Stata Conference</em>. <a href="https://ideas.repec.org/p/boc/scon16/30.html">https://ideas.repec.org/p/boc/scon16/30.html</a>
</div>
<div id="ref-Barr2013" class="csl-entry" role="listitem">
Barr, D. J., Levy, R., Scheepers, C., &amp; Tily, H. J. (2013). Random effects structure for confirmatory hypothesis testing: Keep it maximal. <em>Journal of Memory and Language</em>, <em>68</em>(3), 255–278. <a href="https://doi.org/10.1016/j.jml.2012.11.001">https://doi.org/10.1016/j.jml.2012.11.001</a>
</div>
<div id="ref-Burkner2018" class="csl-entry" role="listitem">
Burkner, P.-C. (2018). Advanced bayesian multilevel modeling with the r package brms. <em>The R Journal</em>, <em>10</em>(1), 395–411.
</div>
<div id="ref-Finch2017" class="csl-entry" role="listitem">
Finch, W. H., &amp; Bolin, J. E. (2017). <em>Multilevel modeling using mplus</em>. <a href="https://doi.org/10.1201/9781315165882">https://doi.org/10.1201/9781315165882</a>
</div>
<div id="ref-Frank2018" class="csl-entry" role="listitem">
Frank, M. (2018). <em>Mixed effects models: Is it time to go bayesian by default?</em> <a href="http://babieslearninglanguage.blogspot.com/2018/02/mixed-effects-models-is-it-time-to-go.html">http://babieslearninglanguage.blogspot.com/2018/02/mixed-effects-models-is-it-time-to-go.html</a>
</div>
<div id="ref-Gallistel2009" class="csl-entry" role="listitem">
Gallistel, C. R. (2009). <span class="nocase">The importance of proving the null</span>. <em>Psychological Review</em>, <em>116</em>(2), 439–453. <a href="https://doi.org/10.1037/a0015251">https://doi.org/10.1037/a0015251</a>
</div>
<div id="ref-Hox2012" class="csl-entry" role="listitem">
Hox, J., Hox, J. J. C. M., van de Schoot, R., &amp; Matthijsse, S. (2012). How few countries will do? Comparative survey analysis from a bayesian perspective. <em>Survey Research Methods</em>. <a href="https://doi.org/10.18148/srm/2012.v6i2.5033">https://doi.org/10.18148/srm/2012.v6i2.5033</a>
</div>
<div id="ref-Jarosz2014" class="csl-entry" role="listitem">
Jarosz, A. F., &amp; Wiley, J. (2014). What are the odds? A practical guide to computing and reporting bayes factors. <em>Journal of Problem Solving</em>. <a href="https://doi.org/10.7771/1932-6246.1167">https://doi.org/10.7771/1932-6246.1167</a>
</div>
<div id="ref-Kruschke2014" class="csl-entry" role="listitem">
Kruschke, J. K. (2014). <em>Doing bayesian data analysis: A tutorial with r, JAGS, and stan, second edition</em> (pp. 1–759). Elsevier Science. <a href="https://doi.org/10.1016/B978-0-12-405888-0.09999-2">https://doi.org/10.1016/B978-0-12-405888-0.09999-2</a>
</div>
<div id="ref-Kruschke2018" class="csl-entry" role="listitem">
Kruschke, J. K., &amp; Liddell, T. M. (2018). The bayesian new statistics: Hypothesis testing, estimation, meta-analysis, and power analysis from a bayesian perspective. <em>Psychonomic Bulletin <span>&amp;</span> Review</em>, <em>25</em>(1), 178–206. <a href="https://doi.org/10.3758/s13423-016-1221-4">https://doi.org/10.3758/s13423-016-1221-4</a>
</div>
<div id="ref-Matuschek2017" class="csl-entry" role="listitem">
Matuschek, H., Kliegl, R., Vasishth, S., Baayen, H., &amp; Bates, D. (2017). Balancing type i error and power in linear mixed models. <em>Journal of Memory and Language</em>. <a href="https://doi.org/10.1016/j.jml.2017.01.001">https://doi.org/10.1016/j.jml.2017.01.001</a>
</div>
<div id="ref-McNeish2016" class="csl-entry" role="listitem">
McNeish, D. (2016). <span class="nocase">On Using Bayesian Methods to Address Small Sample Problems</span>. <em>Structural Equation Modeling: A Multidisciplinary Journal</em>, <em>23</em>(5), 750–773. <a href="https://doi.org/10.1080/10705511.2016.1186549">https://doi.org/10.1080/10705511.2016.1186549</a>
</div>
<div id="ref-Morey2018" class="csl-entry" role="listitem">
Morey, R. D., Homer, S., &amp; Proulx, T. (2018). Beyond statistics: Accepting the null hypothesis in mature sciences. <em>Advances in Methods and Practices in Psychological Science</em>. <a href="https://doi.org/10.1177/2515245918776023">https://doi.org/10.1177/2515245918776023</a>
</div>
<div id="ref-Muthen2012" class="csl-entry" role="listitem">
Muthen, B., &amp; Asparouhov, T. (2012). <span class="nocase">Bayesian structural equation modeling: A more flexible representation of substantive theory.</span> In <em>Psychological Methods</em> (No. 3; Vol. 17, pp. 313–335). American Psychological Association. <a href="https://doi.org/10.1037/a0026802">https://doi.org/10.1037/a0026802</a>
</div>
<div id="ref-nalborczyk_batailler_loevenbruck_vilain_burkner_2019" class="csl-entry" role="listitem">
Nalborczyk, L., Batailler, C., Loevenbruck, H., Vilain, A., &amp; Burkner, P.-C. (2019). <em>An introduction to bayesian multilevel models using brms: A case study of gender effects on vowel variability in standard indonesian</em>. PsyArXiv. <a href="https://doi.org/10.1044/2018_JSLHR-S-18-0006">https://doi.org/10.1044/2018_JSLHR-S-18-0006</a>
</div>
<div id="ref-Oberauer2022" class="csl-entry" role="listitem">
Oberauer, K. (2022). <span class="nocase">The Importance of Random Slopes in Mixed Models for Bayesian Hypothesis Testing</span>. <em>Psychological Science</em>. <a href="https://doi.org/doi:10.1177/09567976211046884">https://doi.org/doi:10.1177/09567976211046884</a>
</div>
<div id="ref-Rindskopf2020" class="csl-entry" role="listitem">
Rindskopf, D. (2020). <span>Reporting Bayesian Results</span>. <em>Evaluation Review</em>. <a href="https://doi.org/10.1177/0193841X20977619">https://doi.org/10.1177/0193841X20977619</a>
</div>
<div id="ref-Rognli2022" class="csl-entry" role="listitem">
Rognli, E. W., Zahl-Olsen, R., Rekdal, S. S., Hoffart, A., &amp; Bertelsen, T. B. (2022). <span class="nocase">Editorial perspective: Bayesian statistical methods are useful for researchers in child and adolescent mental health</span>. <em>Journal of Child Psychology and Psychiatry</em>, <em>n/a</em>(n/a). https://doi.org/<a href="https://doi.org/10.1111/jcpp.13662">https://doi.org/10.1111/jcpp.13662</a>
</div>
<div id="ref-Schielzeth2009" class="csl-entry" role="listitem">
Schielzeth, H., &amp; Forstmeier, W. (2009). Conclusions beyond support: Overconfident estimates in mixed models. <em>Behavioral Ecology</em>, <em>20</em>, 416–420. <a href="https://doi.org/10.1093/beheco/arn145">https://doi.org/10.1093/beheco/arn145</a>
</div>
<div id="ref-Smid2020" class="csl-entry" role="listitem">
Smid, S. C., McNeish, D., Miočevi’c, M., &amp; van de Schoot, R. (2020). <span class="nocase">Bayesian Versus Frequentist Estimation for Structural Equation Models in Small Sample Contexts: A Systematic Review</span>. <em>Structural Equation Modeling: A Multidisciplinary Journal</em>, <em>27</em>(1), 131–161. <a href="https://doi.org/10.1080/10705511.2019.1577140">https://doi.org/10.1080/10705511.2019.1577140</a>
</div>
<div id="ref-StataCorp2020" class="csl-entry" role="listitem">
StataCorp. (2020). <em>Bayesian multilevel models</em>. <a href="https://www.stata.com/features/overview/bayesian-multilevel-models/">https://www.stata.com/features/overview/bayesian-multilevel-models/</a>
</div>
<div id="ref-Stunnenberg2018" class="csl-entry" role="listitem">
Stunnenberg, B. C., Raaphorst, J., Groenewoud, H. M., Statland, J. M., Griggs, R. C., Woertman, W., Stegeman, D. F., Timmermans, J., Trivedi, J., Matthews, E., Saris, C. G. J., Schouwenberg, B. J., Drost, G., Van Engelen, B. G. M., &amp; Van Der Wilt, G. J. (2018). Effect of mexiletine on muscle stiffness in patients with nondystrophic myotonia evaluated using aggregated n-of-1 trials. <em>JAMA - Journal of the American Medical Association</em>. <a href="https://doi.org/10.1001/jama.2018.18020">https://doi.org/10.1001/jama.2018.18020</a>
</div>
<div id="ref-VandeSchoot2015" class="csl-entry" role="listitem">
van de Schoot, R., Broere, J. J., Perryck, K. H., Zondervan-Zwijnenburg, M., &amp; van Loey, N. E. (2015). <span class="nocase">Analyzing small data sets using Bayesian estimation: the case of posttraumatic stress symptoms following mechanical ventilation in burn survivors</span>. <em>European Journal of Psychotraumatology</em>, <em>6</em>(1), 25216. <a href="https://doi.org/10.3402/ejpt.v6.25216">https://doi.org/10.3402/ejpt.v6.25216</a>
</div>
<div id="ref-VandeSchoot2014" class="csl-entry" role="listitem">
van de Schoot, R., Kaplan, D., Denissen, J., Asendorpf, J. B., Neyer, F. J., &amp; van Aken, M. A. G. (2014). A gentle introduction to bayesian analysis: Applications to developmental research. <em>Child Development</em>, <em>85</em>(3), 842–860. <a href="https://doi.org/10.1111/cdev.12169">https://doi.org/10.1111/cdev.12169</a>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","openEffect":"zoom","loop":false,"descPosition":"bottom","closeEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>